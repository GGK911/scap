package com.cn.msca.utl;

import cn.com.mcsca.pki.core.bouncycastle.asn1.x509.SubjectPublicKeyInfo;
import cn.com.mcsca.pki.core.bouncycastle.jcajce.provider.asymmetric.ec.BCECPrivateKey;
import cn.com.mcsca.pki.core.bouncycastle.jcajce.provider.asymmetric.ec.BCECPublicKey;
import cn.com.mcsca.pki.core.bouncycastle.jce.provider.BouncyCastleProvider;
import cn.com.mcsca.pki.core.bouncycastle.pkcs.PKCS10CertificationRequest;
import cn.com.mcsca.pki.core.bouncycastle.util.encoders.Base64;
import cn.com.msca.util.KeyUtil;

import java.io.ByteArrayInputStream;
import java.nio.charset.StandardCharsets;
import java.security.KeyFactory;
import java.security.KeyPair;
import java.security.Provider;
import java.security.PublicKey;
import java.security.cert.CertificateFactory;
import java.security.cert.X509Certificate;
import java.security.spec.X509EncodedKeySpec;

/**
 * @author TangHaoKai
 * @version V1.0 2024/11/8 16:14
 */
public class KeyUtilTest {
    private static final Provider BC = new BouncyCastleProvider();

    public static void main(String[] args) throws Exception {
        String sm2Pri = "MIGTAgEAMBMGByqGSM49AgEGCCqBHM9VAYItBHkwdwIBAQQgBGo3dacOLVg9J1uGZxZ77QFduzZL+R//vve5v79vSS6gCgYIKoEcz1UBgi2hRANCAASbduQKgJpAnGb7OjWG9Cecy3wwvLn4LG6RBnU0Fk5NLdx9fmVrZ9jIZeBFCCPUDY7+brA3g/PVj6dAVJhWdE8R";
        String alg = KeyUtil.getAlgFromPriKeyOrPubKey(Base64.decode(sm2Pri));
        KeyUtil.getAlgFromPriKeyOrPubKey(Base64.decode("MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQCpkozkHHw8jRbbXVqO48t1yqOO1JZnQmBo1rXa1ck58N3CdSITxNHHFrkOgmqSbpeSgQ+algVvrZTO8MId+A3QiNt1s+SrPb/QBeQs+NpyToJ4wmSX1iK45ex//zt5kRAfzwDhjIRSzIVjXyUfUj33KzRjp8y0VY0w89br8iZXrwIDAQAB"));
        BCECPrivateKey privateKey = (BCECPrivateKey) KeyUtil.parsePriKey(sm2Pri);

        byte[] signValue = KeyUtil.sm2Sign(privateKey, "1234".getBytes(StandardCharsets.UTF_8), null);
        String signValueBase64 = Base64.toBase64String(signValue);
        System.out.println(String.format("%-16s", "signValueBase64>> ") + signValueBase64);

        KeyFactory keyFact = KeyFactory.getInstance("EC", BC);

        // 从P10拿公钥
        String P10 = "MIIBQjCB6QIBADCBhjEPMA0GA1UECAwG6YeN5bqGMQ8wDQYDVQQHDAbph43luoYxIjAgBgkqhkiG9w0BCQEWEzEzOTgzMDUzNDU1QDE2My5jb20xCzAJBgNVBAYTAkNOMQ8wDQYDVQQKEwZHR0s5MTExDzANBgNVBAsTBkdHSzkxMTEPMA0GA1UEAxMGR0dLOTExMFkwEwYHKoZIzj0CAQYIKoEcz1UBgi0DQgAE9jdVHgMaJmGbdmHpAjjZX9w5LQaZc4sQwCdAeImpPquatiLRuOIg/49lSGdUk9urydKLlLzcDWO0lXJqSNVauaAAMAoGCCqBHM9VAYN1A0gAMEUCIE7q8pezVi8gRbx4oaisHkio3pJlfcnywKfIg6qxVQLQAiEA0vUXx0pbS3Eu2Bz0f/QIYG44p0efZn/x/2uWTmj3IAA=";
        PKCS10CertificationRequest pkcs10CertificationRequest = new PKCS10CertificationRequest(Base64.decode(P10));
        SubjectPublicKeyInfo subjectPublicKeyInfo = pkcs10CertificationRequest.getSubjectPublicKeyInfo();
        BCECPublicKey publicKey = (BCECPublicKey) keyFact.generatePublic(new X509EncodedKeySpec(subjectPublicKeyInfo.getEncoded()));

        // 从公钥证书拿公钥
        String publicKeyCert = "MIICsDCCAlOgAwIBAgIQGOjscdxYHn/RySLkMEHObjAMBggqgRzPVQGDdQUAMC0xCzAJBgNVBAYTAkNOMQ4wDAYDVQQKDAVNQ1NDQTEOMAwGA1UEAwwFTUNTQ0EwHhcNMjQxMTA4MDYxNjU0WhcNMjUxMTA4MDYxNjU0WjBiMQswCQYDVQQGEwJDTjEjMCEGCSqGSIb3DQEJARYUemhhbmdzYW5AZXhhbXBsZS5jb20xLjAsBgNVBAMMJTEyMzQ1NkDlvKDkuIlAMDUyMjEyMTIwMDEwMzIxNjIxNkAwMDIwWTATBgcqhkjOPQIBBggqgRzPVQGCLQNCAAQNUeI6+ybG01Rgm42xBWqPgjuwQ6bW5dFTCRZ9mvMamzpz4zCG0tTBpWBLVVjbB2/vOc3AKlwBQ5Dvpbu3zp8Go4IBHDCCARgwCwYDVR0PBAQDAgTwMAwGA1UdEwQFMAMBAQAwHwYDVR0jBBgwFoAU8SIKZ5iN9eOyqsMXa8BCH75LvXYwHQYDVR0OBBYEFOkMnFGqbMBY9LBtPehsA6NLbApoMIG6BgNVHR8EgbIwga8wLqAsoCqGKGh0dHA6Ly93d3cubWNzY2EuY29tLmNuL3NtMi9jcmwvY3JsMC5jcmwwfaB7oHmGd2xkYXA6Ly93d3cubWNzY2EuY29tLmNuOjM4OS9DTj1jcmwwLE9VPUNSTCxPPU1DU0NBLEM9Q04/Y2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdD9iYXNlP29iamVjdGNsYXNzPWNSTERpc3RyaWJ1dGlvblBvaW50MAwGCCqBHM9VAYN1BQADSQAwRgIhAMDAW6xDWH7i/ekgyP1YFi9KnoOVWPbBPiv4SokJS8MQAiEA3SlB30S3FcKoFY6Vv3PIXKrySEp29LTE0tZm8lO75Zs=";
        CertificateFactory certFact = CertificateFactory.getInstance("X.509", new BouncyCastleProvider());
        X509Certificate certificate = (X509Certificate) certFact.generateCertificate(new ByteArrayInputStream(Base64.decode(publicKeyCert)));
        publicKey = (BCECPublicKey) certificate.getPublicKey();

        byte[] message = Base64.decode("MIIZVQIBBDCCGRgwgha7MA8WAkVTAgEEFgZkaWFuanUWFmE4UWJSUW9teG5kZ1ZGemE5bElUTGEwggN7AgEEDBLlvKDkuInkuKrkurrljbDnq6ACAQEwggMqBIIDJjCCAyIwggLGoAMCAQICEBKSAXmQjdLlRcnFY3FroH8wDAYIKoEcz1UBg3UFADAtMQswCQYDVQQGEwJDTjEOMAwGA1UECgwFTUNTQ0ExDjAMBgNVBAMMBU1DU0NBMB4XDTI0MTEwODA2MTY1NFoXDTI1MTEwODA2MTY1NFowYjELMAkGA1UEBhMCQ04xIzAhBgkqhkiG9w0BCQEWFHpoYW5nc2FuQGV4YW1wbGUuY29tMS4wLAYDVQQDDCUxMjM0NTZA5byg5LiJQDA1MjIxMjEyMDAxMDMyMTYyMTZAMDAyMFkwEwYHKoZIzj0CAQYIKoEcz1UBgi0DQgAE67p9+mg5UUOSQ8XR1KFK0NOJDokH+3YSrIWTYFJ+9U9jZ1fBOFKgEP7eIOuBBt8UclZouUwxw/sxHKbiitr1e6OCAY8wggGLMAwGA1UdEwQFMAMBAQAwHQYDVR0OBBYEFJS6RrpPiA3NoEdSnPvNSS1rC8UIMIG6BgNVHR8EgbIwga8wLqAsoCqGKGh0dHA6Ly93d3cubWNzY2EuY29tLmNuL3NtMi9jcmwvY3JsMC5jcmwwfaB7oHmGd2xkYXA6Ly93d3cubWNzY2EuY29tLmNuOjM4OS9DTj1jcmwwLE9VPUNSTCxPPU1DU0NBLEM9Q04/Y2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdD9iYXNlP29iamVjdGNsYXNzPWNSTERpc3RyaWJ1dGlvblBvaW50MAsGA1UdDwQEAwIEMDATBgNVHSUEDDAKBggrBgEFBQcDATBcBggrBgEFBQcBAQRQME4wKAYIKwYBBQUHMAKGHGh0dHA6Ly8xMjcuMC4wLjEvY2Fpc3N1ZS5odG0wIgYIKwYBBQUHMAGGFmh0dHA6Ly8xMjcuMC4wLjE6MjA0NDMwHwYDVR0jBBgwFoAU8SIKZ5iN9eOyqsMXa8BCH75LvXYwDAYIKoEcz1UBg3UFAANIADBFAiEAwpVckMPUPboIcbtSTYRku2CfZOHgK9rIim1R/NsqZuACIGxHkDMomAvdd/BDFgtv7uyHyoNcCyCFWmt85HYrtRZ3GA8yMDI0MTEwODA2MjAxNVoYDzIwMjQxMTA4MDYyMDE1WhgPMjAyNTExMDgwNjE2NTRaMIITDxYDcG5nBIITAIlQTkcNChoKAAAADUlIRFIAAAEsAAABLAgGAAAAeX2OdQAAEsdJREFUeNrtnS1QHEsXhhErVqxYgUAgEAhERAQCgViBQERERCAiEFcgrkAgIhBUIRAIBCIiYgUCEYGIQCAQCERERAQCsQKBQCAQiBXcma+Gqnxkf6Z7+uec7uetOoViuuf0Oc929/TPzMvMzAuGYZgGm8EJGIYBLAzDMICFYRjAwjAMA1gYhmEAC8MwgIVhGKYUWDMIIRRQAAshBLAQQghgIYQAFsBCCAEshBACWAghgAWwEEIACyGEABZCCGABLIQQwEIIIYCFEAJYAAshBLAQQghgIYQAFsBCCAEshNJOsnZhwypvTvAIwEJIY5Jt4B2AhZCaJKusjZcAFkJagPVqx3gLYCGkBVh/2iqeA1gIhU6wxUZXVyGAhVDABDsCWAALoWSHg3gNYCGkAlh4DGAhFCu5tg2B1cJrAAuhWMn1SO8KYCGU4nCQ3hXAQkgFsBbwFsBCKGZibTAUBFgIaUmsu5rAWsJbAAshDcPBT3gKYCEUO6lOGQoCLIRS6l3xVRBgIaQCWDt4CWAhNCrAe2/i9shzeUvkDcBCyDbAx32tm/VU3jDFnJnwTnsACyF3AX45IYYvHZc1l9pRyEWdu5I+IAAslDqwvoeK4+JBF6nli7TtRQALpQ6svZrJduI5uVuJw+rVVgAWQvYBvt3kxE9M1kmpAAulDqx1ABLFNgAWQuYB3quZYDfVBD32t9HDQigQsBZqJtkm3nIyl/XIHBZCAEsDsAYx6wKwUE4JB7AU+A9gIRIOYAEshEg4/AewEAJYAAtgIRIOASyESDj8B7AQAlgAC2AhEg4BLIRIOPwHsBACWAALYCESzub5gd/tq89TVAEWQokDK1R+BDxJFWAhlDqwKjv38D4mZ3xdASyAhQCWyfOPI7yPs6vNAFZayfC1OuRsFW8ArCn2T1lOQ2tyCmgbYOWdCLcj/PIFRAAsoXYAsEiEUfYRTAAsYTaQ6j+AJSMR9kEFwPKVL8XD+gawumcOC2DVbcgHkAGwIgLrUbr/AJasRHipbgRugQ6AFRpYGvwHsOQBq7Q7viQCLIAFsLQAiz1rAAtgASx1wMJ3AAtgASxdwCpsGZQALIAFsDQA63fN5z/52GpBOwEsgEUimFin5vPXJm1q5csjwAJYAMs3sG4My3iYtCCwvIodJAEsgAWwmgzZxtmGp4Ap9zR2QRPAAlgAa5LzBgawOm9QznWN5z+BJoAFsACWK2C1GpTTNlhR/xlEASyABbBGOe8yZLAaDEHLea95UAWwABbAigmsNRanAiyABbBUAKsq88Fw0/VH2glgASyAVTrgNAKw3lkspWgBLIAFsABWP1KwXltAawCwAJbH99sCWABrXLldy0Wruzmu18r8AL9OIP/tASz5iXAcawK8eOAPS2g9AqysgLUAsADWq/P2Yn6xKx56FvrKJ4ClDlg9gAWwRADLJFlGzWnlMhmfObD+AVgASxKw2g2g9ZLDyvjMr/naA1gASwywXCQMwAJYAAtghQTWVcOg3gdYQYC16dCuQi03AFjpJMKOlF5MUcAvelnMYflYNFyznD7Akp8Im4KANQ+wANYb+xrQfwALYIWbSwFYyQHre2D/ASyAZVyfIcDKA1hVuYcVuMo4XIrsP4AFsKzqdAKw8gCWMP/9AFgAy6ZObYAlD1gZ+O8SYAGsYHNZAMsrsGYBFsACWOPrdQywggLr56ghUipbnwAWwPJdry7ACgesDOIcYAEs73U7BFgAK6D/BgALYDWpWwdgASyABbBUAMsg0AAWwHISRwALYIUC1gUJB7AAFsCKDaxdbtUBWAALYGkBVqs6WZTzsAAWwKIhZQOrZh2fSDiABbAAlhhfTalbl4QDWAALYGkA1hMJB7AAFsCSBqxDX1dAASz8B7AAlq/6npZbKEqAkXAAq6bvlgAWwErl/Wdd3CwMsJy+62DMRuw1y+c9ACyApf29T8e8541QqGbVwyrnJmu+8311kcrcmOfMSdstAbAAlusey5awui7kOiRscJNS2UvblnjiB8ACWKbv/EXTyvmiLu+Yw5rYK3ZmAAtgSXzn5xrvey2ovj2A9X/+OPIErE8AC2BJe99raQHssI02M4vdf7X1rgAWwHI5dyV1Kcc2wHLXpmNsDWABLGnvumURyBcC6r0PsKb6aNgAVq3AdQVYAMvrL/Fj5Hp/z/0AQ0/t+0taPQEWwHp9z1bDIcNOxLoPXjI/D8zx/ORFTH8BLIBV5z2/aZmUtRjurM6gOl9Ty9Xy85J7glGAVS3002I7Bkm7oNTWHE3MPoIFlCKwXrBkbYuUQ8kNCWvOO2A67Zq0Q6kBa57ETtrek3ooqUn34uEnJHaydkvqoaSAVfMLD6bUSD2UHLBqTsLHXOPjZVmDQeL3CGEEsGQBa9xK5fLUgI3IzgNYCAGsqUPDfmFtAc4DWAgBrJEVvZK2KhlgIQSwNDkPYCEEsNQ4bxdgIQSwtDhvD2AhBLC0OO8IYCEEsLQ4rw+wEAJYAAtgIQSwHDvvAmAhBLC0OO8SYCEEsLQ47xZgIQSwtDhvALAQAlhanPcAsBACWOqdpxlYxXMPuEACASyApQVYo8raJl0QwAJYooA16eoy0sVbHL1+bS6PUTrCIwALYDkqm5QJGkd9vAOwANb4cuscl/OVtIkSRxd4CmCFAtajEmDVLfeU1Inzw5f7fCLAAlgASx+wXu0AXwEsH4F2LR1YxbPuDJOlDWqiAyu7PARYYQLtXAGwTBOFORUZwFrHVwDLdaAdSgZW8ZyOZbL8AjfRgHWKrwCWieNmfU2SRgBWv8Ev/BzICQ6sRXwFsEwd984gwDaFA6vJkOQW5ITzP74CWLaO2zIItBWpwCqHFk0nfQu7ATsAC2DJdty+r2FTYGC9uDCwA7AAlmzHnfoKslDAKv6/C7AAFsDKw3G3CQDLBk79yso7GT8XtgByABbAku+4oWZglaCxgNUTeAFYAIsgiwEshn0AC2DhOICFABbAAljOgFX8X4vFigALYOE4LcA6oHcFsABWPk7rKAeWae/qB1gBWABLr9MWMwNWF6wALICl12kftAKr+J8NQ1hxxRfAAljKnXZiEGTPUoBV7vlj7gpgAaz8nPbT58Zgj8DikD6ABbAydNrQIMhOFQOLuSuABbByCrByzkgCsCzObF8FJQALYOUHrCUhwGLuqnm7n/vwEe0CsCQBqx0bWNXJCgDLX7svAiyAlW0X3gOwhobAOgdPf/lwzVc+eLxBvPwqfJ/SlWwAK3FgWewbZN1Vc+jPx4wnV8trABbAigGsM0NgrYCn5nOAlR1FAtZzqjkLsMwdZrKP8DYmsCyGggegaaQfv/o8PtrHD+DbDwSp5C3AMnfYqkGAfYsMLNPkaoEnJ+CPDqypyQ2wsgnebYMA24oFrHIehVXtUYeDpe3EnmKY8rwOwEo/eO9991gcAYtlDJGApWxOtAuwCN5Qn7l7Y/5/1zDJ7sHS2LY41Q6sGmVcASyAFRNYpkOXZdDkbDi4JzSmllxe9guw0gvg5xjAsri+axssjW2HjRBD61BD97InNeX5dwArrQB+F2IS2xZY1U3Ov5i7ita7WpAMrJplDQBWOgFsMje0GwFY56y7igcsydMMb8p70JrbAMvMWWch5oUaAIt1V+7aej7Uh4sYPWKtPS2AJXOuwRhYFl8G22BpYhsMBba3S2BtapwyAFjpAGvI3JWzdv4Y8itrrHYr612z3FmApS+IewaB9SsksIq/T4YJNguW4s9dxQaWYex0AJauID4OtVTAAlisao8HrB+agWVYfhtg6QlikyuylkIBy3CpBeddTfd938CXQ01TDY7q0AJYzF/ZlrVtCKv3IGmi3ztCv9iFANaBQT32ARbAsimLifZ4Q8H7lIBV1eOL9FuVAFY9J61KnYRlKBgNWK3UgGXhg2WAJTOQH5QDC1hN9/mlgT8XY0EigB9WJH9xBlgChwoegMVpDJP9vRx5aYGoYX3dRaVNbjcHWHKA9U0asECSbGBIbEuLOPsMsHQCa0UYsDicb7KvTa5BW88IWDsWsfYeYGX4C+wQVksgST4spPaWy0WxFjHXBlhxA7oneSEhPyj6QSG5TS1jbwNgxQvqZ4OG2hQELPYLTvbxnMalBBH8tGUZfy2AJX/+qiMEWD9B0lQfD6UsCZHea5bUwwdYk53Tlr5VI5X75gK3611NP95JA0Ikf7WkQAtgTXaOyfnoP4QA6xgkufFvbnNpnmJyG2DJbKRPAoLjkGOPdcFKEbCWG8TlIsCSB6xWbGCBo6l+7db05RzActvzB1j+G+cy1l49y6BYE+Czkzd1OhN0UmXdo2POJINA05wuwJL7a7IXGVj3Avy1PqZuvxW1Z096rCnLC4AltGG6kYNiQYC/vglOspVUJrQF+HIIsOTB6qPUT7dS22HSJa6R69ULtUMhE2B1AJbu3pXrq5eeJKwotqj3QOtEsaZ4E9LWDwBLL7CeHZa7E3PuzNdQQXA7/tIWb0Lqa9rL+gKw5ADrm6Mybb7A9DT4LFJ9fmqJX41LVyKOQADWG4ccRjhOZt7y6wvAsvSn1h9IhXW+BVh+G+Ip9Pqr8jkAy1k9VrTFrVJgnbKXMH4jfAo94V0846jBCmKAZZj82qcglNX7FmD5bYDQt+N0m2x3AFh/1WHa7dxtgKX7xwFgWQZOuXXHQXm3AMtZ+UOtsap5v6ik46SzApbFfWzvG5b32cG5VwBrZuo162cKYo8N7gDLa+/qrmFZF46OQc4eWMXDryeUfZBg7C0ArMyBZXHWz8eAAQqw7MrdTiEJARbAGuWE36G65cU//wuwvJe5nEoSAiyA1bjH06CcG4ewyhpY5a1AoybaM4g/gJUzsKrA934jTYPrkgBWxkkouc0BVhwHnPk+n9rBeivRwTttMyxIAlgAy83LvzMMlhOLMkyvSFpTCKxNgBUMWJv4Kl9g/TYMlo5FGdemJz8oBNY+wAJYAMvvi5vu4fti+PyuwXGywz9hqBBYA4AVDFh7+CpPYA19bnQuL4YwePY7ywDuaUg4kASwAFbYIBkYPtvkTK2nBnXrKfFlGyw5i8VDfJUZsCyOeF32GIDzGQBrGSw5i5c+vsoPWF4Wihpu8dl3UD8twOqDJWfxeIKvMgJWOQdgGCDnNZ/bMpgX6zsKYC3AugNLzoB1ia/yApbpZHu75nMHrnpsmoBVt1eZSLJ0qpM2zl3dBGPxAwqwcgFWeYaVj1XtBs/bcfw8CcDqZwQs050Il9VZXZvVha7dhj+exh+AAJZuYJkcgfxY85lXNZ+36yExelp8mkiylGvrdm2va3dkPwFWBsAqd7m7/jI45aRL60/RyoCV7UmZ1dauq8DA2gVYiQPL4t6/D1Oet1r3VmjLzdLJASuHRCvecb1qc2/AmslcuQDr1mVQ1BwSlHcNznmGgCZgPWWWWGcegLUCsBIHlsXNNJsTnrXja5O0RmAZDImt9mOmnmCGNpxBWQDLSZd72hEqpl8CEwHWgCFNGGiBqgyAZXF114eGsPoUOMB7ChNxL8Mkm2sAq2cwlQ+wnpvOsRgcwPcpAgg0Auvl7XqkTBKtZ+GnFojKBFiGa2V+j/j/bjVxXuvQvUgg6EX07zpDHC/tugeWMgNW3dXXf9jsiGfUOc9qK3LPJSawTgGWk3a9K2wDFGUKLJsLH0Y840ON/9uI0Si+hqGee7AACwEsB/MqwzHPuIm5ANKg/gdK/AywEMAa8TLbLhbilSc0VDc09/+wvVBDMIP6n0XycwdgIYDV7EXahklzpbFR3th9pPodNATWD1IPZQuscj7JMGEetDZK7DaoOb9H7woBrDEv0LKYAF5IBVih95c5OFrlhrRDOQMruV93ie9UDuPYYoIAVrPKH6d4vKwFCA481qU8AvnE0QbeE1IOZQkswxtq/rf1Rsv9eJYwuK6O5HVp9y9uj0fpkHIoO2BZzlstKmqUR8egkGBXpBvKDlhFoZ9Tv2WkOno3KWCRaihXYJkmSzu1hlFo30g1lB2wqtXnJolynGLDKLMn0gxlBaxqQ/OTycJQ7WcJGZzDJdm+kGIoR2CZfK0a2l7+ILBxrhTD6oj0QtkBy+L2kYWEGqcT+dJOW7sntVB2wJpyzIv6r4EGfjjXAClfBxoiJB5Yhida/k79/OvysD4PCzldWHlu/nfOH0dZAstinVUr48ZbqC432Axg69Xugi5pgwBWjQqNsFWaECGAFQVYBhPs5TBkieZDCGBFAVa5GtpgcneWpkMIYAUHVjmsM+hVLdNkCAGsmMCqczvzHZO9CCEJwJoGq1M+mSOERAALIYQAFkIIYAEshBDAQgghgIUQAlgACyEEsBBCCGAhhAAWQggBLIQQAlgIIYCFEEIACyGEABZCCGAhhBDAQggBLICFEAJYCCEkBVgYhmFSDGBhGAawMAzDABaGYQALwzAMYGEYhgEsDMNys/8AUwU7t9SLouAAAAAASUVORK5CYIICARQCARQEggIBMIIB/TCCAaCgAwIBAgIMajEAAAAAAXu7f8TpMAwGCCqBHM9VAYN1BQAwQzELMAkGA1UEBhMCQ04xDTALBgNVBAoMBE5KQ0ExDTALBgNVBAsMBE5KQ0ExFjAUBgNVBAMMDU5KQ0FfVEVTVF9TTTIwHhcNMjQxMDI0MTYwMDAwWhcNMjUxMDI1MTU1OTU5WjA8MQswCQYDVQQGEwJDTjEtMCsGA1UEAwwk5YyX5Lqs54K56IGa5L+h5oGv5oqA5pyv5pyJ6ZmQ5YWs5Y+4MFkwEwYHKoZIzj0CAQYIKoEcz1UBgi0DQgAEMqrHSszn6QPrx9GUPQ8icl5+TXhoZVUek/sPEJEYmjh65icSL702lwu8qSoCe8Akkn11I8Ua3F2LczbowkV63aN/MH0wDAYDVR0TBAUwAwEBADAgBgNVHSUBAf8EFjAUBggrBgEFBQcDAgYIKwYBBQUHAwgwCwYDVR0PBAQDAgDAMB8GA1UdIwQYMBaAFNSPDhSV4JJLNK3zKNvXer6zFtf4MB0GA1UdDgQWBBTGjPcOeqcQp8Rm6IEjdvFaUM3AlTAMBggqgRzPVQGDdQUAA0kAMEYCIQDcvso1Kby/yVPPk73tD71jmewCemzHVi0sPO0PlvXfpgIhAK7h5CLl41BjyAOqkwN0JDG37JqoaU3SsIg/A9fzoBIOBggqgRzPVQGDdQNIADBFAiEA+O7H+eUw+7QBpMPdXbYfVHQ6rdkfthsfuswr4QURY2kCIA+ilmZRfh+fHpPlivzU3pF48Tjt72XG1hel3xqHy3gMGA8yMDI0MTEwODA2Mjc0MVoDIQB6wjUXLCoGDrDivcPIs5GfO9jr7IDIj3abIIdFpih9bRYA");
        byte[] signBytes = Base64.decode("MEQCID8f/GH756JT4qs72LbTk00MDxuk6CwyghSJ4n4HcXlHAiAmOgr+olBdNZYl7Z7lgjlf08ZrvCjUYSMB0wWuGO7/EQ==");


        boolean verifySign = KeyUtil.sm2VerifySign(publicKey, message, signBytes, null);
        System.out.println(String.format("%-16s", "verifySign>> ") + verifySign);

        boolean matchSM2PriAndPub = KeyUtil.matchSM2PriAndPub(privateKey, publicKey);
        System.out.println(String.format("%-16s", "matchSM2PriAndPub>> ") + matchSM2PriAndPub);

        KeyPair keyPair = cn.com.mcsca.pki.core.util.KeyUtil.generateKeyPair("SM2", 256);
        String pri = Base64.toBase64String(keyPair.getPrivate().getEncoded());
        String pub = Base64.toBase64String(keyPair.getPublic().getEncoded());

        boolean matchSM2PriAndPub1 = KeyUtil.matchSM2PriAndPub(pri, pub);
        System.out.println(String.format("%-16s", "matchSM2PriAndPub1>> ") + matchSM2PriAndPub1);

        KeyUtil.extraPublicKeyFromCSR("MIIBQjCB6QIBADCBhjEPMA0GA1UECAwG6YeN5bqGMQ8wDQYDVQQHDAbph43luoYxIjAgBgkqhkiG9w0BCQEWEzEzOTgzMDUzNDU1QDE2My5jb20xCzAJBgNVBAYTAkNOMQ8wDQYDVQQKEwZHR0s5MTExDzANBgNVBAsTBkdHSzkxMTEPMA0GA1UEAxMGR0dLOTExMFkwEwYHKoZIzj0CAQYIKoEcz1UBgi0DQgAE9jdVHgMaJmGbdmHpAjjZX9w5LQaZc4sQwCdAeImpPquatiLRuOIg/49lSGdUk9urydKLlLzcDWO0lXJqSNVauaAAMAoGCCqBHM9VAYN1A0gAMEUCIE7q8pezVi8gRbx4oaisHkio3pJlfcnywKfIg6qxVQLQAiEA0vUXx0pbS3Eu2Bz0f/QIYG44p0efZn/x/2uWTmj3IAA=");
        KeyUtil.extraPublicKeyFromCert("MIICsDCCAlOgAwIBAgIQGOjscdxYHn/RySLkMEHObjAMBggqgRzPVQGDdQUAMC0xCzAJBgNVBAYTAkNOMQ4wDAYDVQQKDAVNQ1NDQTEOMAwGA1UEAwwFTUNTQ0EwHhcNMjQxMTA4MDYxNjU0WhcNMjUxMTA4MDYxNjU0WjBiMQswCQYDVQQGEwJDTjEjMCEGCSqGSIb3DQEJARYUemhhbmdzYW5AZXhhbXBsZS5jb20xLjAsBgNVBAMMJTEyMzQ1NkDlvKDkuIlAMDUyMjEyMTIwMDEwMzIxNjIxNkAwMDIwWTATBgcqhkjOPQIBBggqgRzPVQGCLQNCAAQNUeI6+ybG01Rgm42xBWqPgjuwQ6bW5dFTCRZ9mvMamzpz4zCG0tTBpWBLVVjbB2/vOc3AKlwBQ5Dvpbu3zp8Go4IBHDCCARgwCwYDVR0PBAQDAgTwMAwGA1UdEwQFMAMBAQAwHwYDVR0jBBgwFoAU8SIKZ5iN9eOyqsMXa8BCH75LvXYwHQYDVR0OBBYEFOkMnFGqbMBY9LBtPehsA6NLbApoMIG6BgNVHR8EgbIwga8wLqAsoCqGKGh0dHA6Ly93d3cubWNzY2EuY29tLmNuL3NtMi9jcmwvY3JsMC5jcmwwfaB7oHmGd2xkYXA6Ly93d3cubWNzY2EuY29tLmNuOjM4OS9DTj1jcmwwLE9VPUNSTCxPPU1DU0NBLEM9Q04/Y2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdD9iYXNlP29iamVjdGNsYXNzPWNSTERpc3RyaWJ1dGlvblBvaW50MAwGCCqBHM9VAYN1BQADSQAwRgIhAMDAW6xDWH7i/ekgyP1YFi9KnoOVWPbBPiv4SokJS8MQAiEA3SlB30S3FcKoFY6Vv3PIXKrySEp29LTE0tZm8lO75Zs=");

        int keyLengthFromPublicKey = KeyUtil.getKeyLengthFromPublicKey(pub);
        System.out.println(keyLengthFromPublicKey);

    }
}
